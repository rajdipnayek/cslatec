/* ddaws.f -- translated by f2c (version 12.02.01).
   You must link the resulting object file with libf2c:
	on Microsoft Windows system, link with libf2c.lib;
	on Linux or Unix systems, link with .../path/to/libf2c.a -lm
	or, if you install libf2c.a in a standard place, with -lf2c -lm
	-- in that order, at the end of the command line, as in
		cc *.o -lf2c -lm
	Source for libf2c is in /netlib/f2c/libf2c.zip, e.g.,

		http://www.netlib.org/f2c/libf2c.zip
*/

#include <stdlib.h> /* For exit() */
#include <f2c.h>

/* Table of constant values */

static integer c__3 = 3;
static integer c__21 = 21;
static integer c__45 = 45;
static integer c__75 = 75;
static integer c__1 = 1;
static integer c__2 = 2;

/* DECK DDAWS */
doublereal ddaws_(doublereal *x)
{
    /* Initialized data */

    static doublereal dawcs[21] = { -.006351734375145949201065127736293,
	    -.2294071479677386939899824125866,
	    .02213050093908476441683979161786,
	    -.001549265453892985046743057753375,
	    8.497327715684917456777542948066e-5,
	    -3.828266270972014924994099521309e-6,
	    1.462854806250163197757148949539e-7,
	    -4.851982381825991798846715425114e-9,
	    1.421463577759139790347568183304e-10,
	    -3.728836087920596525335493054088e-12,
	    8.854942961778203370194565231369e-14,
	    -1.920757131350206355421648417493e-15,
	    3.834325867246327588241074439253e-17,
	    -7.089154168175881633584099327999e-19,
	    1.22055213588945767441690112e-20,
	    -1.966204826605348760299451733333e-22,
	    2.975845541376597189113173333333e-24,
	    -4.247069514800596951039999999999e-26,
	    5.734270767391742798506666666666e-28,
	    -7.345836823178450261333333333333e-30,
	    8.951937667516552533333333333333e-32 };
    static doublereal daw2cs[45] = { -.056886544105215527114160533733674,
	    -.31811346996168131279322878048822,
	    .20873845413642236789741580198858,
	    -.12475409913779131214073498314784,
	    .067869305186676777092847516423676,
	    -.033659144895270939503068230966587,
	    .01526078127198797174368246038164,
	    -.0063483709625962148230586094788535,
	    .0024326740920748520596865966109343,
	    -8.6219541491065032038526983549637e-4,
	    2.8376573336321625302857636538295e-4,
	    -8.7057549874170423699396581464335e-5,
	    2.4986849985481658331800044137276e-5,
	    -6.731928676416029434460305033952e-6,
	    1.7078578785573543710504524047844e-6,
	    -4.0917551226475381271896592490038e-7,
	    9.2828292216755773260751785312273e-8,
	    -1.9991403610147617829845096332198e-8,
	    4.0963490644082195241210487868917e-9,
	    -8.0032409540993168075706781753561e-10,
	    1.493850312876146505914322555011e-10,
	    -2.6687999885622329284924651063339e-11,
	    4.5712216985159458151405617724103e-12,
	    -7.5187305222043565872243727326771e-13,
	    1.1893100052629681879029828987302e-13,
	    -1.8116907933852346973490318263084e-14,
	    2.6611733684358969193001612199626e-15,
	    -3.773886305212941979544410990593e-16,
	    5.1727953789087172679680082229329e-17,
	    -6.8603684084077500979419564670102e-18,
	    8.8123751354161071806469337321745e-19,
	    -1.0974248249996606292106299624652e-19,
	    1.3261199326367178513595545891635e-20,
	    -1.5562732768137380785488776571562e-21,
	    1.7751425583655720607833415570773e-22,
	    -1.9695006967006578384953608765439e-23,
	    2.1270074896998699661924010120533e-24,
	    -2.2375398124627973794182113962666e-25,
	    2.2942768578582348946971383125333e-26,
	    -2.2943788846552928693329592319999e-27,
	    2.23917021005924536183422976e-28,
	    -2.1338230616608897703678225066666e-29,
	    1.9866196585123531518028458666666e-30,
	    -1.8079295866694391771955199999999e-31,
	    1.6090686015283030305450666666666e-32 };
    static doublereal dawacs[75] = { .01690485637765703755422637438849,
	    .008683252278406957990536107850768,
	    2.424864042417715453277703459889e-4,
	    1.261182399572690001651949240377e-5,
	    1.066453314636176955705691125906e-6,
	    1.358159794790727611348424505728e-7,
	    2.171042356577298398904312744743e-8,
	    2.867010501805295270343676804813e-9,
	    -1.901336393035820112282492378024e-10,
	    -3.097780484395201125532065774268e-10,
	    -1.029414876057509247398132286413e-10,
	    -6.260356459459576150417587283121e-12,
	    8.563132497446451216262303166276e-12,
	    3.033045148075659292976266276257e-12,
	    -2.523618306809291372630886938826e-13,
	    -4.21060479544066451317546193451e-13,
	    -4.431140826646238312143429452036e-14,
	    4.911210272841205205940037065117e-14,
	    1.235856242283903407076477954739e-14,
	    -5.788733199016569246955765071069e-15,
	    -2.28272329480735862097818395703e-15,
	    7.63714941101412647631236291759e-16,
	    3.851546883566811728777594002095e-16,
	    -1.199932056928290592803237283045e-16,
	    -6.31343915009457234733427028525e-17,
	    2.239559965972975375254912790237e-17,
	    9.987925830076495995132891200749e-18,
	    -4.681068274322495334536246507252e-18,
	    -1.436303644349721337241628751534e-18,
	    1.02082273141054111297790803213e-18,
	    1.538908873136092072837389822372e-19,
	    -2.189157877645793888894790926056e-19,
	    2.156879197938651750392359152517e-21,
	    4.370219827442449851134792557395e-20,
	    -8.234581460977207241098927905177e-21,
	    -7.49864872125646622290320283542e-21,
	    3.282536720735671610957612930039e-21,
	    8.858064309503921116076561515151e-22,
	    -9.185087111727002988094460531485e-22,
	    2.978962223788748988314166045791e-23,
	    1.972132136618471883159505468041e-22,
	    -5.974775596362906638089584995117e-23,
	    -2.834410031503850965443825182441e-23,
	    2.209560791131554514777150489012e-23,
	    -5.439955741897144300079480307711e-26,
	    -5.21354924329484866801713669647e-24,
	    1.702350556813114199065671499076e-24,
	    6.917400860836148343022185660197e-25,
	    -6.540941793002752512239445125802e-25,
	    6.093576580439328960371824654636e-26,
	    1.408070432905187461501945080272e-25,
	    -6.785886121054846331167674943755e-26,
	    -9.799732036214295711741583102225e-27,
	    2.12124490309904133259896093916e-26,
	    -5.954455022548790938238802154487e-27,
	    -3.093088861875470177838847232049e-27,
	    2.854389216344524682400691986104e-27,
	    -3.951289447379305566023477271811e-28,
	    -5.906000648607628478116840894453e-28,
	    3.670236964668687003647889980609e-28,
	    -4.839958238042276256598303038941e-30,
	    -9.799265984210443869597404017022e-29,
	    4.6847737326121306061589088043e-29,
	    5.030877696993461051647667603155e-30,
	    -1.547395051706028239247552068295e-29,
	    6.112180185086419243976005662714e-30,
	    1.357913399124811650343602736158e-30,
	    -2.417687752768673088385304299044e-30,
	    8.369074582074298945292887587291e-31,
	    2.665413042788979165838319401566e-31,
	    -3.811653692354890336935691003712e-31,
	    1.230054721884951464371706872585e-31,
	    4.622506399041493508805536929983e-32,
	    -6.120087296881677722911435593001e-32,
	    1.966024640193164686956230217896e-32 };
    static logical first = TRUE_;

    /* System generated locals */
    real r__1;
    doublereal ret_val, d__1, d__2;

    /* Local variables */
    static doublereal y;
    static real eps;
    static doublereal xbig, xmax, xsml;
    static integer ntdaw;
    extern doublereal d1mach_(integer *);
    static integer ntdaw2, ntdawa;
    extern doublereal dcsevl_(doublereal *, doublereal *, integer *);
    extern integer initds_(doublereal *, integer *, real *);
    extern /* Subroutine */ int xermsg_(char *, char *, char *, integer *, 
	    integer *, ftnlen, ftnlen, ftnlen);

/* ***BEGIN PROLOGUE  DDAWS */
/* ***PURPOSE  Compute Dawson's function. */
/* ***LIBRARY   SLATEC (FNLIB) */
/* ***CATEGORY  C8C */
/* ***TYPE      DOUBLE PRECISION (DAWS-S, DDAWS-D) */
/* ***KEYWORDS  DAWSON'S FUNCTION, FNLIB, SPECIAL FUNCTIONS */
/* ***AUTHOR  Fullerton, W., (LANL) */
/* ***DESCRIPTION */

/* DDAWS(X) calculates the double precision Dawson's integral */
/* for double precision argument X. */

/* Series for DAW        on the interval  0.          to  1.00000E+00 */
/*                                        with weighted error   8.95E-32 */
/*                                         log weighted error  31.05 */
/*                               significant figures required  30.41 */
/*                                    decimal places required  31.71 */

/* Series for DAW2       on the interval  0.          to  1.60000E+01 */
/*                                        with weighted error   1.61E-32 */
/*                                         log weighted error  31.79 */
/*                               significant figures required  31.40 */
/*                                    decimal places required  32.62 */

/* Series for DAWA       on the interval  0.          to  6.25000E-02 */
/*                                        with weighted error   1.97E-32 */
/*                                         log weighted error  31.71 */
/*                               significant figures required  29.79 */
/*                                    decimal places required  32.64 */

/* ***REFERENCES  (NONE) */
/* ***ROUTINES CALLED  D1MACH, DCSEVL, INITDS, XERMSG */
/* ***REVISION HISTORY  (YYMMDD) */
/*   780401  DATE WRITTEN */
/*   890531  Changed all specific intrinsics to generic.  (WRB) */
/*   890531  REVISION DATE from Version 3.2 */
/*   891214  Prologue converted to Version 4.0 format.  (BAB) */
/*   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ) */
/*   920618  Removed space from variable names.  (RWC, WRB) */
/* ***END PROLOGUE  DDAWS */
/* ***FIRST EXECUTABLE STATEMENT  DDAWS */
    if (first) {
	eps = d1mach_(&c__3);
	r__1 = eps * .1f;
	ntdaw = initds_(dawcs, &c__21, &r__1);
	r__1 = eps * .1f;
	ntdaw2 = initds_(daw2cs, &c__45, &r__1);
	r__1 = eps * .1f;
	ntdawa = initds_(dawacs, &c__75, &r__1);

	xsml = sqrt(eps * 1.5f);
	xbig = sqrt(.5f / eps);
/* Computing MIN */
	d__1 = -log(d1mach_(&c__1) * 2.), d__2 = log(d1mach_(&c__2));
	xmax = exp(min(d__1,d__2) - .001);
    }
    first = FALSE_;

    y = abs(*x);
    if (y > 1.) {
	goto L20;
    }

    ret_val = *x;
    if (y <= xsml) {
	return ret_val;
    }

    d__1 = y * 2. * y - 1.;
    ret_val = *x * (dcsevl_(&d__1, dawcs, &ntdaw) + .75);
    return ret_val;

L20:
    if (y > 4.) {
	goto L30;
    }
    d__1 = y * .125 * y - 1.;
    ret_val = *x * (dcsevl_(&d__1, daw2cs, &ntdaw2) + .25);
    return ret_val;

L30:
    if (y > xmax) {
	goto L40;
    }
    ret_val = .5 / *x;
    if (y > xbig) {
	return ret_val;
    }

/* Computing 2nd power */
    d__2 = y;
    d__1 = 32. / (d__2 * d__2) - 1.;
    ret_val = (dcsevl_(&d__1, dawacs, &ntdawa) + .5) / *x;
    return ret_val;

L40:
    xermsg_("SLATEC", "DDAWS", "ABS(X) SO LARGE DAWS UNDERFLOWS", &c__1, &
	    c__1, (ftnlen)6, (ftnlen)5, (ftnlen)31);
    ret_val = 0.;
    return ret_val;

} /* ddaws_ */

