/* de1.f -- translated by f2c (version 12.02.01).
   You must link the resulting object file with libf2c:
	on Microsoft Windows system, link with libf2c.lib;
	on Linux or Unix systems, link with .../path/to/libf2c.a -lm
	or, if you install libf2c.a in a standard place, with -lf2c -lm
	-- in that order, at the end of the command line, as in
		cc *.o -lf2c -lm
	Source for libf2c is in /netlib/f2c/libf2c.zip, e.g.,

		http://www.netlib.org/f2c/libf2c.zip
*/

#include <stdlib.h> /* For exit() */
#include <f2c.h>

/* Table of constant values */

static integer c__3 = 3;
static integer c__50 = 50;
static integer c__60 = 60;
static integer c__41 = 41;
static integer c__29 = 29;
static integer c__25 = 25;
static integer c__64 = 64;
static integer c__1 = 1;
static integer c__2 = 2;

/* DECK DE1 */
doublereal de1_(doublereal *x)
{
    /* Initialized data */

    static doublereal ae10cs[50] = { .03284394579616699087873844201881,
	    -.01669920452031362851476184343387,
	    2.845284724361346807424899853252e-4,
	    -7.563944358516206489487866938533e-6,
	    2.798971289450859157504843180879e-7,
	    -1.357901828534531069525563926255e-8,
	    8.343596202040469255856102904906e-10,
	    -6.370971727640248438275242988532e-11,
	    6.007247608811861235760831561584e-12,
	    -7.022876174679773590750626150088e-13,
	    1.018302673703687693096652346883e-13,
	    -1.761812903430880040406309966422e-14,
	    3.250828614235360694244030353877e-15,
	    -5.071770025505818678824872259044e-16,
	    1.665177387043294298172486084156e-17,
	    3.166753890797514400677003536555e-17,
	    -1.588403763664141515133118343538e-17,
	    4.175513256138018833003034618484e-18,
	    -2.892347749707141906710714478852e-19,
	    -2.800625903396608103506340589669e-19,
	    1.322938639539270903707580023781e-19,
	    -1.804447444177301627283887833557e-20,
	    -7.905384086522616076291644817604e-21,
	    4.435711366369570103946235838027e-21,
	    -4.264103994978120868865309206555e-22,
	    -3.920101766937117541553713162048e-22,
	    1.527378051343994266343752326971e-22,
	    1.024849527049372339310308783117e-23,
	    -2.134907874771433576262711405882e-23,
	    3.239139475160028267061694700366e-24,
	    2.142183762299889954762643168296e-24,
	    -8.234609419601018414700348082312e-25,
	    -1.52465282964580947961369440114e-25,
	    1.378208282460639134668480364325e-25,
	    2.131311202833947879523224999253e-27,
	    -2.012649651526484121817466763127e-26,
	    1.995535662263358016106311782673e-27,
	    2.798995808984003464948686520319e-27,
	    -5.534511845389626637640819277823e-28,
	    -3.884995396159968861682544026146e-28,
	    1.121304434507359382850680354679e-28,
	    5.566568152423740948256563833514e-29,
	    -2.045482929810499700448533938176e-29,
	    -8.453813992712336233411457493674e-30,
	    3.565758433431291562816111116287e-30,
	    1.383653872125634705539949098871e-30,
	    -6.062167864451372436584533764778e-31,
	    -2.447198043989313267437655119189e-31,
	    1.00685064093399834801154818048e-31,
	    4.623685555014869015664341461674e-32 };
    static doublereal ae11cs[60] = { .20263150647078889499401236517381,
	    -.073655140991203130439536898728034,
	    .006390934911836191586275328384002,
	    -6.0797252705247911780653153363999e-4,
	    -7.3706498620176629330681411493484e-5,
	    4.8732857449450183453464992488076e-5,
	    -2.3837064840448290766588489460235e-6,
	    -3.0518612628561521027027332246121e-6,
	    1.7050331572564559009688032992907e-7,
	    2.3834204527487747258601598136403e-7,
	    1.078177255616316656259687236402e-8,
	    -1.7955692847399102653642691446599e-8,
	    -4.1284072341950457727912394640436e-9,
	    6.8622148588631968618346844526664e-10,
	    5.3130183120506356147602009675961e-10,
	    7.8796880261490694831305022893515e-11,
	    -2.6261762329356522290341675271232e-11,
	    -1.54836876363082619631257562941e-11,
	    -2.5818962377261390492802405122591e-12,
	    5.9542879191591072658903529959352e-13,
	    4.6451400387681525833784919321405e-13,
	    1.1557855023255861496288006203731e-13,
	    -1.047523687083579901231754718967e-15,
	    -1.1896653502709004368104489260929e-14,
	    -4.774907749026177875264301934995e-15,
	    -8.1077649615772777976249734754135e-16,
	    1.3435569250031554199376987998178e-16,
	    1.4134530022913106260248873881287e-16,
	    4.9451592573953173115520663232883e-17,
	    7.9884048480080665648858587399367e-18,
	    -1.4008632188089809829248711935393e-18,
	    -1.481424695841737210772280400168e-18,
	    -5.5826173646025601904010693937113e-19,
	    -1.1442074542191647264783072544598e-19,
	    2.5371823879566853500524018479923e-21,
	    1.3205328154805359813278863389097e-20,
	    6.2930261081586809166287426789485e-21,
	    1.7688270424882713734999261332548e-21,
	    2.3266187985146045209674296887432e-22,
	    -6.7803060811125233043773831844113e-23,
	    -5.9440876959676373802874150531891e-23,
	    -2.3618214531184415968532592503466e-23,
	    -6.0214499724601478214168478744576e-24,
	    -6.5517906474348299071370444144639e-25,
	    2.9388755297497724587042038699349e-25,
	    2.260160620064211517321572875851e-25,
	    8.9534369245958628745091206873087e-26,
	    2.4015923471098457555772067457706e-26,
	    3.4118376888907172955666423043413e-27,
	    -7.1617071694630342052355013345279e-28,
	    -7.5620390659281725157928651980799e-28,
	    -3.37746121574673246379529207808e-28,
	    -1.0479325703300941711526430332245e-28,
	    -2.1654550252170342240854880201386e-29,
	    -7.5297125745288269994689298432e-31,
	    1.9103179392798935768638084000426e-30,
	    1.1492104966530338547790728833706e-30,
	    4.38969705826617515144103591936e-31,
	    1.2320883239205686471647157725866e-31,
	    2.2220174457553175317538581162666e-32 };
    static doublereal ae12cs[41] = { .63629589796747038767129887806803,
	    -.13081168675067634385812671121135,
	    -.0084367410213053930014487662129752,
	    .0026568491531006685413029428068906,
	    3.2822721781658133778792170142517e-4,
	    -2.378344777143024826957980785105e-5,
	    -1.1439804308100055514447076797047e-5,
	    -1.4405943433238338455239717699323e-6,
	    5.2415956651148829963772818061664e-9,
	    3.8407306407844323480979203059716e-8,
	    8.5880244860267195879660515759344e-9,
	    1.0219226625855003286339969553911e-9,
	    2.1749132323289724542821339805992e-11,
	    -2.2090238142623144809523503811741e-11,
	    -6.3457533544928753294383622208801e-12,
	    -1.0837746566857661115340539732919e-12,
	    -1.1909822872222586730262200440277e-13,
	    -2.8438682389265590299508766008661e-15,
	    2.5080327026686769668587195487546e-15,
	    7.8729641528559842431597726421265e-16,
	    1.5475066347785217148484334637329e-16,
	    2.257532283166507505527260819729e-17,
	    2.2233352867266608760281380836693e-18,
	    1.6967819563544153513464194662399e-20,
	    -5.7608316255947682105310087304533e-20,
	    -1.7591235774646878055625369408853e-20,
	    -3.6286056375103174394755328682666e-21,
	    -5.9235569797328991652558143488e-22,
	    -7.6030380926310191114429136895999e-23,
	    -6.2547843521711763842641428479999e-24,
	    2.54833607593076486060376064e-25,
	    2.5598615731739857020168874666666e-25,
	    7.13762393578993188002070528e-26,1.47037599395675681815789568e-26,
	    2.5105524765386733555198634666666e-27,
	    3.5886666387790890886583637333333e-28,
	    3.9886035156771301763317759999999e-29,
	    2.1763676947356220478805333333333e-30,
	    -4.6146998487618942367607466666666e-31,
	    -2.0713517877481987707153066666666e-31,
	    -5.1890378563534371596970666666666e-32 };
    static doublereal e11cs[29] = { -16.11346165557149402572066392756618,
	    7.7940727787426802769272245891741497,
	    -1.9554058188631419507127283812814491,
	    .37337293866277945611517190865690209,
	    -.056925031910929019385263892220051166,
	    .0072110777696600918537847724812635813,
	    -7.8104901449841593997715184089064148e-4,
	    7.3880933562621681878974881366177858e-5,
	    -6.2028618758082045134358133607909712e-6,
	    4.6816002303176735524405823868362657e-7,
	    -3.2092888533298649524072553027228719e-8,
	    2.0151997487404533394826262213019548e-9,
	    -1.1673686816697793105356271695015419e-10,
	    6.2762706672039943397788748379615573e-12,
	    -3.14815416722754410452467818023936e-13,
	    1.4799041744493474210894472251733333e-14,
	    -6.5457091583979673774263401588053333e-16,
	    2.7336872223137291142508012748799999e-17,
	    -1.0813524349754406876721727624533333e-18,
	    4.0628328040434303295300348586666666e-20,
	    -1.4535539358960455858914372266666666e-21,
	    4.9632746181648636830198442666666666e-23,
	    -1.620861269663604460486656e-24,
	    5.0721448038607422226431999999999999e-26,
	    -1.5235811133372207813973333333333333e-27,
	    4.4001511256103618696533333333333333e-29,
	    -1.2236141945416231594666666666666666e-30,
	    3.2809216661066001066666666666666666e-32,-8.4933452268306432e-34 }
	    ;
    static doublereal e12cs[25] = { -.03739021479220279511668698204827,
	    .04272398606220957726049179176528,
	    -.130318207984970054415392055219726,
	    .0144191240246988907341095893982137,
	    -.00134617078051068022116121527983553,
	    1.07310292530637799976115850970073e-4,
	    -7.42999951611943649610283062223163e-6,
	    4.53773256907537139386383211511827e-7,
	    -2.47641721139060131846547423802912e-8,
	    1.22076581374590953700228167846102e-9,
	    -5.48514148064092393821357398028261e-11,
	    2.26362142130078799293688162377002e-12,
	    -8.6358972716980097940417291628224e-14,
	    3.06291553669332997581032894881279e-15,
	    -1.01485718855944147557128906734933e-16,
	    3.15482174034069877546855328426666e-18,
	    -9.236042407692409544840159232e-20,
	    2.55504267970814002440435029333333e-21,
	    -6.69912805684566847217882453333333e-23,
	    1.66925405435387319431987199999999e-24,
	    -3.96254925184379641856e-26,
	    8.98135896598511332010666666666666e-28,
	    -1.94763366993016433322666666666666e-29,
	    4.04836019024630033066666666666666e-31,-8.0798156769984512e-33 };
    static doublereal ae13cs[50] = { -.60577324664060345999319382737747,
	    -.11253524348366090030649768852718,
	    .013432266247902779492487859329414,
	    -.0019268451873811457249246838991303,
	    3.0911833772060318335586737475368e-4,
	    -5.3564132129618418776393559795147e-5,
	    9.8278128802474923952491882717237e-6,
	    -1.885368984916518282690289193891e-6,
	    3.7494319356894735406964042190531e-7,
	    -7.6823455870552639273733465680556e-8,
	    1.6143270567198777552956300060868e-8,
	    -3.4668022114907354566309060226027e-9,
	    7.5875420919036277572889747054114e-10,
	    -1.6886433329881412573514526636703e-10,
	    3.8145706749552265682804250927272e-11,
	    -8.7330266324446292706851718272334e-12,
	    2.023672864586796096179431106433e-12,
	    -4.741328303955583465521034082016e-13,
	    1.122117204838986432473179992892e-13,
	    -2.6804225434840309912826809093395e-14,
	    6.4578514417716530343580369067212e-15,
	    -1.5682760501666478830305702849194e-15,
	    3.8367865399315404861821516441408e-16,
	    -9.4517173027579130478871048932556e-17,
	    2.3434812288949573293896666439133e-17,
	    -5.8458661580214714576123194419882e-18,
	    1.4666229867947778605873617419195e-18,
	    -3.6993923476444472706592538274474e-19,
	    9.3790159936721242136014291817813e-20,
	    -2.3893673221937873136308224087381e-20,
	    6.1150624629497608051934223837866e-21,
	    -1.5718585327554025507719853288106e-21,
	    4.0572387285585397769519294491306e-22,
	    -1.0514026554738034990566367122773e-22,
	    2.7349664930638667785806003131733e-23,
	    -7.1401604080205796099355574271999e-24,
	    1.8705552432235079986756924211199e-24,
	    -4.9167468166870480520478020949333e-25,
	    1.2964988119684031730916087125333e-25,
	    -3.4292515688362864461623940437333e-26,
	    9.0972241643887034329104820906666e-27,
	    -2.4202112314316856489934847999999e-27,
	    6.4563612934639510757670475093333e-28,
	    -1.7269132735340541122315987626666e-28,
	    4.6308611659151500715194231466666e-29,
	    -1.2448703637214131241755170133333e-29,
	    3.3544574090520678532907007999999e-30,
	    -9.0598868521070774437543935999999e-31,
	    2.4524147051474238587273216e-31,
	    -6.6528178733552062817107967999999e-32 };
    static doublereal ae14cs[64] = { -.189291800075301682549567994282,
	    -.08648117855259871489968817056824,
	    .007224101543746594747021514839184,
	    -8.097559457557386197159655610181e-4,
	    1.099913443266138867179251157002e-4,
	    -1.717332998937767371495358814487e-5,
	    2.985627514479283322825342495003e-6,
	    -5.659649145771930056560167267155e-7,
	    1.152680839714140019226583501663e-7,
	    -2.495030440269338228842128765065e-8,
	    5.69232420183375436703937036814e-9,
	    -1.359957664805600338490030939176e-9,
	    3.384662888760884590184512925859e-10,
	    -8.73785390447468195235084931658e-11,
	    2.33158866322265971861261340047e-11,
	    -6.411481049213785969753165196326e-12,
	    1.812246980204816433384359484682e-12,
	    -5.253831761558460688819403840466e-13,
	    1.559218272591925698855028609825e-13,
	    -4.729168297080398718476429369466e-14,
	    1.463761864393243502076199493808e-14,
	    -4.617388988712924102232173623604e-15,
	    1.482710348289369323789239660371e-15,
	    -4.841672496239229146973165734417e-16,
	    1.606215575700290408116571966188e-16,
	    -5.408917538957170947895023784252e-17,
	    1.84747015934689788137023140231e-17,
	    -6.39583079275909447050061042505e-18,
	    2.24278072169975945725023327617e-18,
	    -7.961369173983947552744555308646e-19,
	    2.859308111540197459808619929272e-19,
	    -1.038450244701137145900697137446e-19,
	    3.812040607097975780866841008319e-20,
	    -1.413795417717200768717562723696e-20,
	    5.295367865182740958305442594815e-21,
	    -2.002264245026825902137211131439e-21,
	    7.640262751275196014736848610918e-22,
	    -2.941119006868787883311263523362e-22,
	    1.141823539078927193037691483586e-22,
	    -4.469308475955298425247020718489e-23,
	    1.76326241057175077063049140852e-23,
	    -7.00996818792590235635151826234e-24,
	    2.807573556558378922287757507515e-24,
	    -1.132560944981086432141888891562e-24,
	    4.600574684375017946156764233727e-25,
	    -1.881448598976133459864609148108e-25,
	    7.744916111507730845444328478037e-26,
	    -3.208512760585368926702703826261e-26,
	    1.337445542910839760619930421384e-26,
	    -5.60867188180221704889477173521e-27,
	    2.365839716528537483710069473279e-27,
	    -1.003656195025305334065834526856e-27,
	    4.281490878094161131286642556927e-28,
	    -1.83634526181531819969132695825e-28,
	    7.917798231349540000097468678144e-29,
	    -3.431542358742220361025015775231e-29,
	    1.494705493897103237475066008917e-29,
	    -6.542620279865705439739042420053e-30,
	    2.877581395199171114340487353685e-30,
	    -1.271557211796024711027981200042e-30,
	    5.644615555648722522388044622506e-31,
	    -2.516994994284095106080616830293e-31,
	    1.127259818927510206370368804181e-31,
	    -5.06981487580046085556258471936e-32 };
    static logical first = TRUE_;

    /* System generated locals */
    doublereal ret_val, d__1;

    /* Local variables */
    static real eta;
    static integer nte11, nte12;
    static doublereal xmax;
    static integer ntae10, ntae11, ntae12, ntae13, ntae14;
    extern doublereal d1mach_(integer *);
    static doublereal xmaxt;
    extern doublereal dcsevl_(doublereal *, doublereal *, integer *);
    extern integer initds_(doublereal *, integer *, real *);
    extern /* Subroutine */ int xermsg_(char *, char *, char *, integer *, 
	    integer *, ftnlen, ftnlen, ftnlen);

/* ***BEGIN PROLOGUE  DE1 */
/* ***PURPOSE  Compute the exponential integral E1(X). */
/* ***LIBRARY   SLATEC (FNLIB) */
/* ***CATEGORY  C5 */
/* ***TYPE      DOUBLE PRECISION (E1-S, DE1-D) */
/* ***KEYWORDS  E1 FUNCTION, EXPONENTIAL INTEGRAL, FNLIB, */
/*             SPECIAL FUNCTIONS */
/* ***AUTHOR  Fullerton, W., (LANL) */
/* ***DESCRIPTION */

/* DE1 calculates the double precision exponential integral, E1(X), for */
/* positive double precision argument X and the Cauchy principal value */
/* for negative X.  If principal values are used everywhere, then, for */
/* all X, */

/*    E1(X) = -Ei(-X) */
/* or */
/*    Ei(X) = -E1(-X). */


/* Series for AE10       on the interval -3.12500E-02 to  0. */
/*                                        with weighted error   4.62E-32 */
/*                                         log weighted error  31.34 */
/*                               significant figures required  29.70 */
/*                                    decimal places required  32.18 */


/* Series for AE11       on the interval -1.25000E-01 to -3.12500E-02 */
/*                                        with weighted error   2.22E-32 */
/*                                         log weighted error  31.65 */
/*                               significant figures required  30.75 */
/*                                    decimal places required  32.54 */


/* Series for AE12       on the interval -2.50000E-01 to -1.25000E-01 */
/*                                        with weighted error   5.19E-32 */
/*                                         log weighted error  31.28 */
/*                               significant figures required  30.82 */
/*                                    decimal places required  32.09 */


/* Series for E11        on the interval -4.00000E+00 to -1.00000E+00 */
/*                                        with weighted error   8.49E-34 */
/*                                         log weighted error  33.07 */
/*                               significant figures required  34.13 */
/*                                    decimal places required  33.80 */


/* Series for E12        on the interval -1.00000E+00 to  1.00000E+00 */
/*                                        with weighted error   8.08E-33 */
/*                                         log weighted error  32.09 */
/*                        approx significant figures required  30.4 */
/*                                    decimal places required  32.79 */


/* Series for AE13       on the interval  2.50000E-01 to  1.00000E+00 */
/*                                        with weighted error   6.65E-32 */
/*                                         log weighted error  31.18 */
/*                               significant figures required  30.69 */
/*                                    decimal places required  32.03 */


/* Series for AE14       on the interval  0.          to  2.50000E-01 */
/*                                        with weighted error   5.07E-32 */
/*                                         log weighted error  31.30 */
/*                               significant figures required  30.40 */
/*                                    decimal places required  32.20 */

/* ***REFERENCES  (NONE) */
/* ***ROUTINES CALLED  D1MACH, DCSEVL, INITDS, XERMSG */
/* ***REVISION HISTORY  (YYMMDD) */
/*   770701  DATE WRITTEN */
/*   890531  Changed all specific intrinsics to generic.  (WRB) */
/*   891115  Modified prologue description.  (WRB) */
/*   891115  REVISION DATE from Version 3.2 */
/*   891214  Prologue converted to Version 4.0 format.  (BAB) */
/*   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ) */
/*   920618  Removed space from variable names.  (RWC, WRB) */
/* ***END PROLOGUE  DE1 */
/* ***FIRST EXECUTABLE STATEMENT  DE1 */
    if (first) {
	eta = (real) d1mach_(&c__3) * .1f;
	ntae10 = initds_(ae10cs, &c__50, &eta);
	ntae11 = initds_(ae11cs, &c__60, &eta);
	ntae12 = initds_(ae12cs, &c__41, &eta);
	nte11 = initds_(e11cs, &c__29, &eta);
	nte12 = initds_(e12cs, &c__25, &eta);
	ntae13 = initds_(ae13cs, &c__50, &eta);
	ntae14 = initds_(ae14cs, &c__64, &eta);

	xmaxt = -log(d1mach_(&c__1));
	xmax = xmaxt - log(xmaxt);
    }
    first = FALSE_;

    if (*x > -1.) {
	goto L50;
    }
    if (*x > -32.) {
	goto L20;
    }
    d__1 = 64. / *x + 1.;
    ret_val = exp(-(*x)) / *x * (dcsevl_(&d__1, ae10cs, &ntae10) + 1.);
    return ret_val;

L20:
    if (*x > -8.) {
	goto L30;
    }
    d__1 = (64. / *x + 5.) / 3.;
    ret_val = exp(-(*x)) / *x * (dcsevl_(&d__1, ae11cs, &ntae11) + 1.);
    return ret_val;

L30:
    if (*x > -4.) {
	goto L40;
    }
    d__1 = 16. / *x + 3.;
    ret_val = exp(-(*x)) / *x * (dcsevl_(&d__1, ae12cs, &ntae12) + 1.);
    return ret_val;

L40:
    d__1 = (*x * 2. + 5.) / 3.;
    ret_val = -log(-(*x)) + dcsevl_(&d__1, e11cs, &nte11);
    return ret_val;

L50:
    if (*x > 1.) {
	goto L60;
    }
    if (*x == 0.) {
	xermsg_("SLATEC", "DE1", "X IS 0", &c__2, &c__2, (ftnlen)6, (ftnlen)3,
		 (ftnlen)6);
    }
    ret_val = -log((abs(*x))) - .6875 + *x + dcsevl_(x, e12cs, &nte12);
    return ret_val;

L60:
    if (*x > 4.) {
	goto L70;
    }
    d__1 = (8. / *x - 5.) / 3.;
    ret_val = exp(-(*x)) / *x * (dcsevl_(&d__1, ae13cs, &ntae13) + 1.);
    return ret_val;

L70:
    if (*x > xmax) {
	goto L80;
    }
    d__1 = 8. / *x - 1.;
    ret_val = exp(-(*x)) / *x * (dcsevl_(&d__1, ae14cs, &ntae14) + 1.);
    return ret_val;

L80:
    xermsg_("SLATEC", "DE1", "X SO BIG E1 UNDERFLOWS", &c__1, &c__1, (ftnlen)
	    6, (ftnlen)3, (ftnlen)22);
    ret_val = 0.;
    return ret_val;

} /* de1_ */

